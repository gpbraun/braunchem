%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  ______                       _____ _                      %
%  | ___ \                     /  __ \ |                     %
%  | |_/ /_ __ __ _ _   _ _ __ | /  \/ |__   ___ _ __ ___    %
%  | ___ \ '__/ _` | | | | '_ \| |   | '_ \ / _ \ '_ ` _ \   %
%  | |_/ / | | (_| | |_| | | | | \__/\ | | |  __/ | | | | |  %
%  \____/|_|  \__,_|\__,_|_| |_|\____/_| |_|\___|_| |_| |_|  %
%                                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  The BRAUNCHEM Package
%
%          --  Beautiful Reaction Schemes  -- 
%
%============================================================%
%
%  GABRIEL P. BRAUN, 2019-2021
%
%============================================================%
%
%  CONTACT: braun.pineschi@gmail.com
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   PACKAGE REQUIREMENTS AND SETUP                   
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage
{ 
    expl3, 
    xparse, 
    l3draw,
    l3graphics,
    chemmacros,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   PACKAGE IDENTIFICATION                        
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ProvidesExplPackage{braunchem}{2021/06/06}{2.0}%
{ Beautiful Reaction Schemes }

%============================================================%
%   VARIANTS OF KERNEL FUNCTIONS
%============================================================%

\cs_generate_variant:Nn \coffin_rotate:Nn {NV}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   PACKAGE KEYS     
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\keys_define:nn { braun/chem }
    {
        %% LOAD CHEMFIG
        chemfig .bool_set:N = \g_bchem_chemfig_bool ,
        chemfig .initial:n  = false,
        chemfig .default:n  = true,

        %% FORMULA FORMAT
        formula-format .code:n = \chemsetup { chemformula/format = #1 },
        formula-format .initial:n = \sffamily,
    }

\ProcessKeysOptions { braun/chem }

\DeclareSIUnit \currie {\text{Ci}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   MACROS           
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cs_set:Npn \BraunNoWarning % Avoid badness errors
    { 
        \dim_set_eq:NN \vfuzz    \c_max_dim
        \dim_set_eq:NN \hfuzz    \c_max_dim
        \int_set_eq:NN \hbadness \c_max_int
        \int_set_eq:NN \vbadness \c_max_int
    }

% #1 -> key options
\cs_new:Npn \BChemSet #1 { \keys_set:nn { braun/chem } {#1} }

% #1 -> Bold formula
\cs_new:Npn \chb #1 { \ch { \bfseries #1 } }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   KINETICS TABLE
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \keys_define:nn { braun/chem }
%     {
%         conc-unit .tl_set:N  = \g_bchem_kinetics_conc_unit_tl,
%         conc-unit .initial:n = {mol.L^{-1}},

%         rate-unit .tl_set:N  = \g_bchem_kinetics_rate_unit_tl,
%         rate-unit .initial:n =  {mol.L^{-1}.s^{-1}},
%     }

% \NewDocumentCommand \KineticsTable { o m m }
%     {
%         \group_begin:
%             \clist_set:Nn \l_tmpa_clist {#2}
%             \begin{tabular}
%                 {
%                     \clist_count:N \l_tmpa_clist
%                     S[ table-format = 1.3 ]
%                     S[ table-format = 1.3 ]
%                     S[ table-format = 2.2 ]
%                 }
%                     \toprule
%                         \ch{[I^-]_0}    & 
%                         \ch{[S2O8^{2-}]_0} & 
%                         Taxa inicial   \\
%                         (\unit{mol.L^{-1}}) &  
%                         (\unit{mol.L^{-1}}) &   
%                         (\unit{\micro\moLar\per\second})} 
%                 \\\midrule #3 \\\bottomrule
%             \end{tabular}
%         \group_end:
%     }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   MODULES
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bool_if:NT \g_bchem_chemfig_bool
    { \file_input:n { functions / braunchem.chemfig.sty } }
    
\file_input:n { functions / braunchem.reactions.sty }
\file_input:n { functions / braunchem.schemes.sty   }
\file_input:n { functions / braunchem.arrows.sty    }
\file_input:n { functions / braunchem.forks.sty     }
\file_input:n { functions / braunchem.molecules.sty }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                              
%   THE END!!!
%                                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%